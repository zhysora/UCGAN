2022-02-06 23:42:02,095 - mmFusion - INFO - Config:
name = 'ucgan_GF-2'
description = 'test ucgan on PSData3/GF-2 dataset'
model_type = 'UCGAN'
work_dir = 'data/PSData3/model_out/ucgan_GF-2'
log_dir = 'logs/ucgan'
log_file = 'logs/ucgan/ucgan_GF-2.log'
log_level = 'INFO'
only_test = True
checkpoint = 'data/PSData3/model_out/ucgan_GF-2/train_out/pretrained.pth'
ms_chans = 4
bit_depth = 10
train_set_cfg = dict(
    dataset=dict(
        type='PSDataset',
        image_dirs=['data/PSData3/Dataset/GF-2/train_full_res'],
        bit_depth=10),
    num_workers=8,
    batch_size=16,
    shuffle=True)
test_set0_cfg = dict(
    dataset=dict(
        type='PSDataset',
        image_dirs=['data/PSData3/Dataset/GF-2/test_full_res'],
        bit_depth=10),
    num_workers=4,
    batch_size=4,
    shuffle=False)
test_set1_cfg = dict(
    dataset=dict(
        type='PSDataset',
        image_dirs=['data/PSData3/Dataset/GF-2/test_low_res'],
        bit_depth=10),
    num_workers=4,
    batch_size=4,
    shuffle=False)
cuda = True
max_iter = 30000
save_freq = 1500
test_freq = 30000
eval_freq = 1500
norm_input = False
optim_cfg = dict(
    core_module=dict(type='AdamW', lr=0.0001),
    Discriminator=dict(type='AdamW', lr=5e-05))
sched_cfg = dict(step_size=15000, gamma=0.9)
loss_cfg = dict(
    QNR_loss=dict(w=1.0),
    cyc_rec_loss=dict(type='l1', w=0.001),
    spectral_rec_loss=dict(type='l1', w=0.0005),
    spatial_rec_loss=dict(type='l1', w=0.0005),
    adv_loss=dict(type='LSGAN', soft_label=True, w=0.001))
model_cfg = dict(
    core_module=dict(
        hp_filter=True,
        num_blocks=(1, 3, 1),
        n_feats=32,
        norm_type='IN',
        block_type='RCA'),
    Discriminator=dict(n_feats=32, norm_type='IN'),
    to_pan_mode='max')

2022-02-06 23:42:02,095 - mmFusion - INFO - ===> Loading Datasets
2022-02-06 23:42:02,096 - mmFusion - INFO - ===> Building Model
2022-02-06 23:42:02,118 - mmFusion - INFO - ===> Setting GPU
2022-02-06 23:42:05,162 - mmFusion - INFO - ===> Loading Checkpoint
2022-02-06 23:42:05,187 - mmFusion - INFO - ===> Setting Optimizer
2022-02-06 23:42:05,188 - mmFusion - INFO - ===> Setting Scheduler
2022-02-06 23:42:05,188 - mmFusion - INFO - ===> Params Count
2022-02-06 23:42:05,189 - mmFusion - INFO - total params of "core_module": 210964
2022-02-06 23:42:05,189 - mmFusion - INFO - total params of "Discriminator": 697313
2022-02-06 23:42:05,189 - mmFusion - INFO - total params: 908277
2022-02-06 23:42:05,190 - mmFusion - INFO - total trainable params of "core_module": 210964
2022-02-06 23:42:05,190 - mmFusion - INFO - total trainable params of "Discriminator": 697313
2022-02-06 23:42:05,190 - mmFusion - INFO - total trainable params: 908277
2022-02-06 23:42:05,190 - mmFusion - INFO - ===> Final Testing
2022-02-06 23:42:05,190 - mmFusion - INFO - Low resolution testing ...
2022-02-06 23:42:14,425 - mmFusion - INFO - SAM metric value: 1.6484 +- 0.0311
2022-02-06 23:42:14,426 - mmFusion - INFO - ERGAS metric value: 2.0353 +- 0.1389
2022-02-06 23:42:14,427 - mmFusion - INFO - Q4 metric value: 0.9568 +- 0.0038
2022-02-06 23:42:14,427 - mmFusion - INFO - SCC metric value: 0.9426 +- 0.0071
2022-02-06 23:42:14,427 - mmFusion - INFO - SSIM metric value: 0.9443 +- 0.0055
2022-02-06 23:42:14,428 - mmFusion - INFO - MPSNR metric value: 37.5502 +- 0.4672
2022-02-06 23:42:14,428 - mmFusion - INFO - SAM metric curve: [1.6484]
2022-02-06 23:42:14,428 - mmFusion - INFO - ERGAS metric curve: [2.0353]
2022-02-06 23:42:14,428 - mmFusion - INFO - Q4 metric curve: [0.9568]
2022-02-06 23:42:14,428 - mmFusion - INFO - SCC metric curve: [0.9426]
2022-02-06 23:42:14,428 - mmFusion - INFO - SSIM metric curve: [0.9443]
2022-02-06 23:42:14,428 - mmFusion - INFO - MPSNR metric curve: [37.5502]
2022-02-06 23:42:14,428 - mmFusion - INFO - Avg time cost per img: 0.10353s
2022-02-06 23:42:14,429 - mmFusion - INFO - Full resolution testing ...
2022-02-06 23:42:15,210 - mmFusion - INFO - D_lambda metric value: 0.0023 +- 0.0008
2022-02-06 23:42:15,211 - mmFusion - INFO - D_s metric value: 0.0073 +- 0.0035
2022-02-06 23:42:15,212 - mmFusion - INFO - QNR metric value: 0.9903 +- 0.0034
2022-02-06 23:42:15,212 - mmFusion - INFO - FCC metric value: 0.9554 +- 0.0043
2022-02-06 23:42:15,212 - mmFusion - INFO - SF metric value: 24.2063 +- 1.0805
2022-02-06 23:42:15,212 - mmFusion - INFO - SD metric value: 59.6539 +- 7.2997
2022-02-06 23:42:15,213 - mmFusion - INFO - SAM_nrf metric value: 1.2099 +- 0.1324
2022-02-06 23:42:15,213 - mmFusion - INFO - D_lambda metric curve: [0.0023]
2022-02-06 23:42:15,213 - mmFusion - INFO - D_s metric curve: [0.0073]
2022-02-06 23:42:15,213 - mmFusion - INFO - QNR metric curve: [0.9903]
2022-02-06 23:42:15,213 - mmFusion - INFO - FCC metric curve: [0.9554]
2022-02-06 23:42:15,214 - mmFusion - INFO - SF metric curve: [24.2063]
2022-02-06 23:42:15,214 - mmFusion - INFO - SD metric curve: [59.6539]
2022-02-06 23:42:15,214 - mmFusion - INFO - SAM_nrf metric curve: [1.2099]
2022-02-06 23:42:15,214 - mmFusion - INFO - Avg time cost per img: 0.00763s
2022-02-06 23:42:15,214 - mmFusion - INFO - ===> Finish !!!
